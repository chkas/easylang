# AoC-20 - Day 20: Jurassic Jigsaw
# 
len rev[] 1024
# 
func build_rev . .
  for i range 1024
    h = i
    v = 0
    for j range 10
      v *= 2
      v = v + h mod 2
      h = h div 2
    .
    rev[i] = v
  .
  rev[] &= 1024
.
call build_rev
# 
func edge_val s$ . n .
  n = 0
  for i range 10
    n *= 2
    n += if substr s$ i 1 = "#"
  .
.
global id[] n[] ed[][] img[] .
func read . .
  repeat
    s$ = input
    until s$ = ""
    id[] &= number substr s$ 5 4
    n[] &= 0
    s$ = input
    call edge_val s$ n
    e[] &= n
    s1$ = substr s$ 0 1
    s2$ = substr s$ 9 1
    for ii range 8
      s$ = input
      for i range 8
        img[] &= if substr s$ i + 1 1 = "#"
      .
      s1$ &= substr s$ 0 1
      s2$ &= substr s$ 9 1
    .
    s$ = input
    s1$ &= substr s$ 0 1
    s2$ &= substr s$ 9 1
    call edge_val s2$ n
    e[] &= n
    call edge_val s$ n
    e[] &= rev[n]
    call edge_val s1$ n
    e[] &= rev[n]
    s$ = input
    ed[][] &= [ ]
    h = len ed[][] - 1
    swap ed[h][] e[]
  .
.
call read
# 
n_tiles = len ed[][]
rows = sqrt n_tiles
# 
func part1 . .
  prod = 1
  for c1 range n_tiles
    n = 0
    m[] = [ ]
    len m[] 4
    for c2 range n_tiles
      if c1 <> c2
        m = 0
        for e1 range 4
          p1 = ed[c1][e1]
          if p1 <> 1024
            for e2 range 4
              p2 = ed[c2][e2]
              if p1 = p2 or p1 = rev[p2]
                m = 1
                m[e1] = 1
              .
            .
          .
        .
        n += m
      .
    .
    n[c1] = n
    if n = 2
      prod *= id[c1]
    .
    if n < 4
      for e range 4
        if m[e] = 0
          ed[c1][e] = 1024
        .
      .
    .
  .
  print prod
.
call part1
# 
# 
# 
func turn i . .
  swap h[] ed[i][]
  h = h[3]
  h[3] = h[2]
  h[2] = h[1]
  h[1] = h[0]
  h[0] = h
  swap h[] ed[i][]
.
# 
func flip i . .
  swap h[] ed[i][]
  x = h[0]
  h[0] = rev[h[2]]
  h[2] = rev[x]
  h[1] = rev[h[1]]
  h[3] = rev[h[3]]
  swap h[] ed[i][]
.
# 
func turn_flip mode start r . .
  len im[] r * r
  if mode = 0
    offs = 0
    inc = 1
    incr = 0
  elif mode = 1
    offs = r - 1
    inc = r
    incr = -r * r - 1
  elif mode = 2
    offs = r * r - 1
    inc = -1
    incr = 0
  elif mode = 3
    offs = r * r - r
    inc = -r
    incr = r * r + 1
  elif mode = 4
    offs = r * r - r
    inc = 1
    incr = -2 * r
  .
  s = start
  d += offs
  for y range r
    for x range r
      im[d] = img[s]
      d += inc
      s += 1
    .
    d += incr
  .
  for i range len im[]
    img[start + i] = im[i]
  .
.
# 
global imgids[] .
func build . .
  # 
  len done[] n_tiles
  # 
  for r range rows
    p1 = 1024
    for c range rows
      if r = 0
        p2 = 1024
      else
        i = imgids[(r - 1) * rows + c]
        p2 = rev[ed[i][2]]
      .
      for i range n_tiles
        if done[i] = 0
          for flip range 2
            for turn range 4
              if p1 = ed[i][3] and p2 = ed[i][0]
                break 3
              .
              call turn i
            .
            call flip i
          .
        .
      .
      done[i] = 1
      p1 = rev[ed[i][1]]
      imgids[] &= i
      start = i * 64
      if flip = 1
        call turn_flip 4 start 8
      .
      call turn_flip turn start 8
    .
  .
.
call build
# 
func expand_img . .
  len imgn[] len img[]
  for r range rows
    for c range rows
      tile = imgids[r * rows + c]
      for y range 8
        for x range 8
          s = tile * 64 + y * 8 + x
          rd = y + r * 8
          cd = x + c * 8
          d = rd * rows * 8 + cd
          imgn[d] = img[s]
        .
      .
    .
  .
  swap imgn[] img[]
.
irows = rows * 8
call expand_img
# 
func show_grafic . .
  f = 100 / irows
  color 003
  rect 100 100
  for r range irows
    for c range irows
      i = r * irows + c
      move c * f r * f
      if img[i] = 1
        color 227
        rect 1 * f 1 * f
      elif img[i] = 2
        color 900
        rect 1.1 * f 1.1 * f
      .
    .
  .
.
monster[][] &= [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 ]
monster[][] &= [ 1 0 0 0 0 1 1 0 0 0 0 1 1 0 0 0 0 1 1 1 ]
monster[][] &= [ 0 1 0 0 1 0 0 1 0 0 1 0 0 1 0 0 1 0 0 0 ]
# 
func search_monster . n_monster .
  for r range irows - 3
    for c range irows - 20
      found = 1
      for mr range 3
        for mc range 20
          if monster[mr][mc] = 1
            i = (r + mr) * irows + c + mc
            if img[i] <> 1
              found = 0
              break 2
            .
          .
        .
      .
      if found = 1
        for mr range 3
          for mc range 20
            if monster[mr][mc] = 1
              i = (r + mr) * irows + c + mc
              img[i] = 2
            .
          .
        .
        n_monster += 1
      .
    .
  .
  if n_monster > 0
    for i range len img[]
      sum += img[i]
    .
    print sum - n_monster * 30
    call show_grafic
  .
.
for f range 2
  for i range 4
    call search_monster found
    if found > 1
      break 2
    .
    call turn_flip 1 0 irows
  .
  call turn_flip 4 0 irows
.
# 
# 
# 
input_data
Tile 1913:
##..#....#
.#.#.#.###
#...##.##.
.....#.#.#
.#......##
.........#
#...###..#
.#..#.....
.##...#..#
#.#...#...

Tile 2579:
##...####.
##..#....#
...#...#.#
#.....###.
##..#...##
#....#..#.
.#.....###
.##...#...
#.........
...##.....

Tile 1531:
.......###
.#....####
.#.#.#...#
....#..#.#
.#.#.##..#
.#.#.#...#
#.##...###
##..#.....
#...#.....
##.##.#..#

Tile 1493:
#.##.#.#..
#.#..#.##.
..#.....#.
#.#.#....#
....#....#
...#####..
#####.#.#.
#.##..##..
..#.....##
.##..#.###

Tile 3109:
########.#
......#.##
#....#...#
##.#.##...
....#.#...
#####...##
....#....#
..##...###
.......#.#
#.##.#....

Tile 3343:
###......#
#..#.#..##
...#....#.
#.........
..#.....##
.....#####
.....####.
##.......#
..#.......
#.......##

Tile 2609:
####..#.##
#.#..#....
....###..#
###..#..#.
#.#......#
##..#..#..
#....#..#.
#......###
#..#....##
.#..#.###.

Tile 1823:
###..#....
..###...#.
..#.###...
...#.....#
#....#.#.#
.#..#.#..#
#..##.#..#
...##.....
....#.#.#.
###.##...#

Tile 3391:
....#...#.
.#.#....#.
#......#..
#..#....#.
#.##...#.#
...##.####
....##..#.
##.#.#..##
.....#..##
#.#.#..#.#

Tile 2753:
....###..#
.#..##.#.#
...#......
..#.###.##
...#..##..
....#.....
#......#..
#........#
......#..#
#..#.#...#

Tile 3989:
.#.###.#..
#......##.
.##......#
.......###
###....###
##........
##....#.#.
...#.#..#.
........#.
###..#..#.

Tile 1877:
...###...#
#.#..##...
.##.###.#.
#.#....#..
#..#.#.##.
#.......##
####..#.#.
##.#....##
.##.......
.#..##..##

Tile 2729:
#...####.#
...#.....#
.###......
...#..#..#
...#.#.#.#
.#.....##.
..#.....##
........#.
###.......
#..##...##

Tile 1031:
##.#..####
#.##.#....
..#.......
#......###
.##.###.##
#...#...#.
#..##.....
#..#.#.#..
....###...
....#.###.

Tile 3803:
#..#..##..
...##..#..
...#.#....
#.....#..#
#........#
.#..#.#.##
..#..#.#..
#..#.#.#..
..##..#.#.
#####.###.

Tile 3541:
.##.#..#..
.##..#...#
.#.#..#...
...#..##.#
..#.....#.
..##......
.##......#
##.......#
.#..#.##.#
###.#.##.#

Tile 3821:
.#.#.#....
..#..##...
#.##......
..#...#.##
#.####..#.
##.##.#...
..#..#....
....#....#
...###.#.#
.#..#.#.##

Tile 3853:
#####..#.#
.....#..##
#...#.##.#
.##....#.#
#.#......#
###...#.#.
##....#.##
#.#.#.#..#
....###...
##.#.#....

Tile 1249:
###...####
..#....#..
##.##....#
.........#
#.........
.##.#.##..
...#...##.
..........
##...#.#..
##.####..#

Tile 3673:
...##..#.#
.#..#..#.#
###......#
#.....###.
..#.#.....
#.#..#.###
.#.##.##..
.##....#..
.#...##..#
#.###..#.#

Tile 3163:
##.#.#####
.##....#..
####......
#..#.#..##
.#.#..##.#
##.....#.#
.......#..
#...#.....
..#..#....
###.#...#.

Tile 1759:
###.#...##
...#..#...
###..###..
.#.#...#.#
.##...#...
..###....#
#.#.....#.
......###.
..#.####.#
##..##..#.

Tile 1831:
.#...#...#
...#.#..##
#...#.#...
#...##.#..
.#.#.#..#.
......##.#
.........#
#....##.#.
......#..#
#..#...##.

Tile 2179:
.###.....#
..######.#
....#....#
...#....#.
#.##..#...
#..#....##
.#..#.#..#
..#.#....#
#.#.#.....
###.##...#

Tile 2713:
..###.#..#
#.#.....#.
#....#.#..
#...##....
##...#.#.#
###..###.#
.##..#..##
.#...##.#.
#.#.......
#...#.....

Tile 1889:
....#....#
......#.#.
##.###...#
.#..##...#
##.##.#..#
...#...##.
#....#...#
.......#..
.#...#..##
.#.####.##

Tile 1999:
##....##.#
#..#.##.##
..#...#...
#.....#...
......#...
#.....#..#
.#.##..#.#
..#..##..#
#...#..#..
###..##..#

Tile 2039:
.#....####
.##..#....
.#.......#
#........#
#.......#.
.#..#.....
#.##......
##....#..#
.........#
#.#......#

Tile 2969:
...#####..
..#.#...##
##.....#..
##.....###
#...#..###
#..#....##
#..##...##
.........#
#...##...#
.#......##

Tile 2153:
.##..###..
#.#..#..##
.#####....
#.#..#.###
#.....#.##
####..#.#.
..........
.#......#.
...##...#.
.#....####

Tile 2837:
..###.....
###.#.###.
.#....#...
##.....###
##.##..###
..#..##.##
.#....##..
#..##.##..
#..#......
#..##...#.

Tile 1619:
##..###.##
##....####
.#..##.#..
##.#...#..
#..##.##..
...#.#.#.#
.....#.##.
..##..#..#
#..#..#..#
......#.#.

Tile 3943:
.#.##.#.#.
.......#.#
.........#
...#..#..#
...#....##
#.#.##....
##.......#
.#..#.##.#
...##.#..#
#.##....#.

Tile 3389:
#...#.##..
#.##..#...
#.#.#.....
##...#...#
##.....#..
.#..###..#
..###.....
#.##..#.##
####....##
##.#.#####

Tile 3631:
##.###.###
#...#.....
..#.......
#....#.###
#.........
#.#.......
....##...#
........#.
#....#....
.....#.#..

Tile 2081:
##..##.#..
.##......#
........##
#.......##
......##.#
#....#....
.#.#...##.
....##..#.
#.#..#####
...#####..

Tile 1579:
##........
.....#...#
#......#..
#..#.#...#
...#..#...
#.##....##
...#......
.#...#..#.
..#....#.#
.##...#...

Tile 3019:
.##..####.
...#....##
...##.#.#.
#....#....
.........#
##..#..#.#
...#.#...#
.#.##.#.##
##..#.....
#..#..###.

Tile 2089:
##.##.#...
..#.##...#
##...#....
#........#
#..#.....#
..######.#
.......#..
...#..##..
#.#....#..
...#.#####

Tile 2297:
#.#.###...
#.##......
#..#..#...
......#..#
#....#...#
###.#..##.
#....##.##
.......#.#
.........#
.###.#.#..

Tile 1373:
#..#.####.
........#.
....#....#
.##..#...#
.#.....#.#
#.....#...
#..#..#..#
.##...##.#
##.......#
.##..#.#..

Tile 1259:
...#..##.#
....#.#..#
#..#.##.##
##..##....
#..#.#..##
#.#...#...
..#......#
...###.#.#
..........
.###..##..

Tile 2411:
.###..#.#.
.#..#..#..
#.....#..#
.#.....#..
##..#...#.
.#........
#...##....
#.#..##...
.....#.#.#
....#.##..

Tile 3359:
.##..##.##
..#.#..#.#
#.......#.
.#..###..#
.#.....#..
#.........
...#.....#
.##....#..
.........#
.#.##..#..

Tile 2437:
.#.....#..
#.#.......
....##.#..
##.###.##.
##.#....#.
#...#....#
##..##..##
...#..#..#
....##.#.#
.##.#.#...

Tile 1367:
....#####.
..#.#....#
##......#.
..##...##.
..##..##.#
..##.##..#
#.#......#
##...#...#
.....#.#..
##.###.###

Tile 3533:
##..####..
##..#....#
...#.....#
#.##..####
###..##...
....###..#
..#.....##
.##.#..#..
....#.##..
##.#.##.##

Tile 1451:
.####.#...
..##.#.#..
...#.#....
.........#
....#...##
##...##...
..#...#...
#...#.####
...#.#.###
#######...

Tile 3457:
#.##.###.#
#..#.#....
###.#....#
.#....#.##
.......##.
#...####.#
#.#####..#
#.#..#..#.
#.#.......
.#.##.....

Tile 2657:
..#####..#
......###.
#.....#..#
.#..###..#
...#.##...
#.....#..#
#....#####
....#..#..
#.#.###..#
.#..##.#..

Tile 2347:
#.##.#.###
#...#....#
..........
#.#.#.....
#....#....
#..#...###
#.##...#..
#.....#..#
#.#.###.#.
#...###.##

Tile 3923:
#.####...#
###...#.##
......#..#
..#..#..##
#....#.#.#
.........#
.....#.#.#
#..####..#
....##.#..
#..#...#..

Tile 2593:
####...#..
#...####.#
#......##.
..#..#....
#..#.....#
...#......
....#.....
#.#...##.#
.......#.#
#.#####.#.

Tile 1103:
..##...#.#
..#.....#.
#....#...#
...##....#
#.#.....##
.#.#.#.#..
#....#####
.#.#.#####
.........#
.##...#.#.

Tile 2671:
.##.##.#.#
...#.#....
##....#...
#......#..
.#....#.##
........##
..#...###.
###...#...
....#.#..#
.#######.#

Tile 3907:
###....#..
..##.....#
..........
##...#..##
##..#..##.
##..##..#.
#.#.....##
..###..#.#
#..#..#..#
#.#.......

Tile 1327:
.#..#..#.#
.###.###..
..#..#....
.#...#.#..
#.##.....#
#..#.#..#.
###...#...
##..#..#.#
......#...
#.#...###.

Tile 1163:
..#.#...#.
####.#.#..
.##.....##
#...#.....
.....####.
#...#..###
...#.##.#.
##..#..#..
.....#.#.#
.###...#.#

Tile 2683:
.......#..
.#.#.##..#
##..#...##
...#......
##.##...#.
...#.#.###
.#.##.....
#..#....#.
.###..#...
.#.#.....#

Tile 3881:
#.#.#..##.
##.#...###
##......##
#.........
#..#......
...#.#...#
.#..##....
.....##.#.
##...#....
###.....#.

Tile 2711:
#...#.#.##
#..##.....
...#......
#.#.#....#
#...#.#...
...#......
.#.#......
..#....#.#
#.##..#...
#.#.#.....

Tile 3491:
.###..#.##
.....#....
.##..#..##
##.##..#.#
.###....##
..##..#..#
..#......#
..#..#...#
#...#.#..#
.......##.

Tile 2339:
###.#####.
.#....#...
##.#.....#
#.........
#.........
..##..##.#
.###......
#...##....
##........
#.....#..#

Tile 1543:
..##...#..
.....#..##
....##....
.........#
.#..#.#..#
..........
.........#
#.#.#.....
##.#.#....
#.#.###..#

Tile 2371:
#..#.#####
##.#..###.
#.#...##..
#...###.##
#...#..#.#
##.....###
.#.......#
.....#.#..
..#.#.####
.###..##..

Tile 2971:
..###.#...
#.........
##.#...###
....###...
###......#
..###....#
##.#.....#
.#.....#..
#.....####
..##.##.#.

Tile 2203:
#.###.#.##
.#...##.#.
#.#.....#.
..#.#....#
##..#....#
##..#.....
#..#..#...
##........
..#..#.#..
##....#..#

Tile 2113:
###...##.#
......#...
.....##.#.
....####.#
##..#..#..
#...#...##
.......#.#
......#..#
#.##.#..##
....##.#..

Tile 1321:
.#..#..#..
##...#...#
..........
.####..#.#
##.#.#.#.#
#..#.#....
#..#.....#
.#.......#
....###.#.
##.#.##.##

Tile 1667:
.#####...#
##....#..#
#..#.#....
..##..#...
#..##...##
...#......
..#..#...#
.....#...#
#..#...#.#
##..#.##..

Tile 3001:
.#.#######
...#.#...#
..##...#.#
#.........
....#.....
#.....##.#
.....####.
#.........
...#.##.##
##.##..###

Tile 1789:
..###.#..#
...##...#.
........#.
####...#.#
#..#..#...
##.##..##.
....#.....
#.#.#.....
#.#..#...#
######.#..

Tile 3677:
.#...#.###
#..##...##
#..#...#.#
##........
..#....###
..........
##..#.##.#
.#........
......##..
.##.##...#

Tile 2693:
#.#.###.#.
#.#..#..#.
.#....#...
#..#...#.#
.#.##..##.
.##......#
...#.....#
##...#.###
.#.#.....#
########..

Tile 2141:
#####.....
#.........
#...#....#
....#.....
.......#..
##..#.#..#
#....#..#.
..#....#..
.....##.#.
##..#.#.#.

Tile 3847:
#...######
#..#.##..#
..#...##.#
##..#.#..#
##..#..#.#
##.##....#
#........#
#....#.#..
#.........
#......#..

Tile 2333:
#.#..##.#.
####.....#
###..#...#
.........#
...##.#..#
###.......
..##...#.#
...###...#
.###.#...#
##..#.##..

Tile 2129:
#..###.###
....#....#
#.#.#..#.#
....#....#
#...#.#..#
..##.##...
#.##....#.
#...#.#...
.#..##...#
...###.##.

Tile 1283:
.#..#.###.
###.#.##.#
#..#..#.#.
.....#...#
.#.#.#....
#...#..#.#
.#.#..#.##
.#..##..#.
#....##.#.
.#..#...#.

Tile 2851:
.##.#.....
###......#
.#........
....#.#..#
.#..#..#..
.##....#..
.##...#.##
#.###.##.#
##........
.#.#.#.#.#

Tile 2311:
#..##....#
.#......#.
....#...##
....#...#.
.#...#...#
#...#....#
.....#.#.#
.....##..#
##..##.###
##..###.#.

Tile 3217:
#.##....##
#.......#.
#.#....#.#
..##.###..
....##...#
#.........
...#.#...#
..##....##
..#......#
##.###..##

Tile 2833:
####..#..#
#...##.#.#
........##
..##..#...
.......#..
......#...
###..#..#.
.##..#...#
##.#....#.
.####.....

Tile 3593:
#..#####..
.##.#....#
...#..#..#
##.#...##.
#######...
...#..#...
#.##..#.#.
#........#
#...##..##
........##

Tile 3299:
...#.#..#.
#.#......#
##......##
.#..#..#..
#.#####...
#...#....#
#.#.......
..#....#.#
.#........
#.#.#.##..

Tile 2719:
...#..#.#.
#..#.###..
......#.##
....#.#..#
#.#......#
....#.....
##..#.#...
...##.....
###.#....#
..####..##

Tile 2161:
..#.##..##
#........#
...#.#...#
...###....
......#..#
..##.##.#.
.#....#.##
#...#####.
#....#...#
.#....#...

Tile 3643:
...#...##.
##......##
....#.###.
.#.#..####
..#.#...##
.##.#.#.#.
#.#..#..#.
#..#.#..#.
.#........
.#.###....

Tile 3767:
.##.#....#
#...#...##
.#...##..#
.#.#......
..#..#..##
#..#.#.##.
#.....#.##
....##...#
.....#.##.
..#..###..

Tile 2377:
.#####.#.#
..#.....##
#...#...#.
##....##..
....#..#..
#.##..#..#
.#...#.##.
...##...#.
#....#....
..#.#..###

Tile 2441:
....#.###.
.#..#....#
.#.###....
#...#.....
#.#.##....
....##....
....##...#
...#..##..
#...###.##
.##.#.#.#.

Tile 2273:
...#..#.#.
#..#...###
..#....#..
...###.#..
.........#
..##.#..##
###.#....#
#..#.....#
....#...#.
.##..#####

Tile 1231:
....#####.
#.....#.#.
..#....#.#
.###..##.#
#..#....##
#..#.#.#..
..#.###...
##........
..#.....##
##.##..#.#

Tile 2879:
#####.###.
#..#..#..#
...#..#..#
#.........
.#.#.#...#
...#..#..#
#.#..#.###
#.....####
.......#.#
..##.#####

Tile 2473:
.##.###..#
....##.#.#
#..#..#..#
..#.#.#...
#..##.....
.##....#..
....##..##
...#.....#
....#.....
.#####.#..

Tile 3329:
#.#..###..
......###.
.###..##..
...#.##...
#..#.#.###
#.###..##.
##..##...#
..#####..#
.#...#....
#.##.#..#.

Tile 1489:
....#....#
#.##.....#
..#......#
..#...#..#
.#....#..#
#..##...#.
..####.##.
.#..##..##
..#.....#.
##.#.##..#

Tile 3259:
..####.###
##.##..#.#
.#..#..###
#.#.......
.....#.#..
##...#.#..
.....#...#
.#....#...
..#.#....#
######....

Tile 1123:
....#.#.#.
...##.....
...##....#
#.##....##
..#...#..#
.#..#.....
.#......##
.........#
.....#...#
.##.###...

Tile 1381:
.###..#.##
#..##..#..
#.....#..#
#..#..#..#
#....#.#.#
.......#.#
#...#.#..#
##..###..#
..#..##...
..##.#..#.

Tile 2903:
#.###.###.
#..###..#.
##.......#
.#....#...
#..#..##.#
...#...#.#
#.#...##.#
......#..#
##.#..#..#
##.#..##.#

Tile 1049:
#....#.###
####.....#
#.##....#.
.#....##..
.##..#..##
#.#.#..#.#
.##...#..#
...#..#.##
.....#..##
..#.#.###.

Tile 3137:
...#.#.#.#
#.#....#..
..###...#.
..#..##..#
.#.#.##.#.
#.#..##..#
#.....#...
##...##.##
#.#...#...
.##.#.....

Tile 2131:
.#......##
...#...##.
.#.#.#.#.#
..........
...#....#.
#.#.#..#.#
..#.#....#
....##....
....##..#.
##.##..#..

Tile 3733:
.#.#....##
.#..#....#
..###.#..#
.....#...#
...#.....#
###..#....
#...#.####
......#...
..#..#....
.#####.#..

Tile 1973:
.#.#.##...
#.....#..#
#......#..
...#...#.#
..#..#...#
####.#....
....#..#.#
.#.....#.#
....#..#.#
..#..#.#..

Tile 3889:
#.##.#...#
#....##..#
.###..#.##
..#...###.
#....##...
#.##......
#.#..#..#.
...#.#...#
........##
##.#..#.#.

Tile 1129:
#...######
#...#.##.#
###.....#.
#.#..#..#.
.#....#...
..#...#..#
#....#.###
......#.#.
#.#..##.##
.###..#..#

Tile 1549:
.#..##.#..
#.#....###
...#..#...
##....#...
..##...#.#
#.#....###
..#.##.##.
.....#...#
#.##.....#
#..#.##...

Tile 2213:
#...#.#.##
#........#
...##...##
.#..##.#.#
#..##....#
...##...##
##........
....#....#
...#.#.#.#
..#.###..#

Tile 1597:
..###..#..
#......#..
.......#.#
#.#....###
#.###..#.#
##.#.##...
#.##.#..##
.#.#..##..
.##..#...#
##...#####

Tile 1777:
#..#....#.
.........#
..#.....#.
..#......#
.##....#..
#...#...#.
.#..#.....
#.....#..#
.#..##...#
#.#...#...

Tile 2503:
#..###.#..
.#..##.#..
....##....
..#..#....
#....#.#..
#.#....#.#
...#.#....
..##.#....
#.#.#....#
#.######..

Tile 3499:
.####...##
.#.##..#..
#........#
..#......#
##..#...#.
#...##....
#......#..
.#.#....##
...#..#...
.##.#...#.

Tile 1811:
#.###...##
..##...#..
..#.#..###
##.#....#.
.#...#....
##.......#
#....#...#
...##.##..
...#.....#
.####..#..

Tile 3793:
###.####..
##...###.#
...#.###..
#....#....
.....#....
...#.....#
###.####..
#.##.##.##
......#...
#.#.###...

Tile 2341:
.##..#.###
.#........
..####..#.
.#..####.#
#....#...#
......##.#
#.....#...
..........
#..###....
####.#####

Tile 3613:
..#.#.#.#.
#....###..
#......#..
#.#...#.##
#..#.....#
##.#.#.#..
...####..#
##...###.#
#.#.#....#
#..####...

Tile 3701:
..##.####.
#.##...###
.###.#....
#..#.....#
##........
###..#.###
..#...#.#.
.##...#..#
##.......#
###.#...##

Tile 1483:
#####..##.
....#..#.#
...#####.#
#.##...#..
........#.
........##
##..##.###
.###....##
...###..#.
...#.#..#.

Tile 3571:
#.#.##.##.
#......##.
#...#.#...
.#.#....#.
#.#....#..
#.#...#...
##.....#.#
##.#.#...#
#....#...#
#.#..#..##

Tile 2521:
##.##..#.#
......#..#
.#.#.#.##.
#........#
.#.##....#
.#....#.#.
##......#.
#....#....
.#..#...#.
.#..#..###

Tile 3413:
.##.##..#.
#...#..#..
##....#..#
..........
#..#...#..
##..#....#
....#.#...
#.....#...
......#.##
..##.##.#.

Tile 1933:
#..#....##
#...#..###
.#......##
......#..#
..........
##.##..###
.......###
...#...###
.#....#..#
#.#..#.#.#

Tile 1021:
.#..##.#.#
##....#...
.#........
.#.#....##
.#......##
##........
.....#..#.
#....#.#.#
#.........
..#.#.##.#

Tile 3323:
...###.#..
.#..####..
....#.....
#.....##.#
###......#
..########
.#....##.#
....##.##.
#..##....#
#.##.#..#.

Tile 1607:
....####..
##.#...#.#
.......#.#
#.........
..#..####.
..#..#.##.
.###.#...#
##...#....
#.######..
##.#.#.###

Tile 1481:
.###...#..
.#......##
.....#...#
...#...##.
#.###.##..
#......###
#.........
###...###.
.#....##..
#....###.#

Tile 1879:
###.##....
#.#.....##
#.#..#.#.#
.#...#..##
......####
#.###.....
......###.
#..#.#..##
..#......#
.#..#.....

Tile 2927:
###..##.#.
#..#....#.
##..#.....
#.#...####
#.........
..###...##
#.####...#
#.##.##..#
...#......
#....#.##.

Tile 1867:
..#..####.
##.##..#.#
.##......#
###..#....
..#......#
#..##..#.#
#.........
...#..#..#
#......#..
.#....#.#.

Tile 2647:
#####.##.#
...#...#..
#.......##
...#..#..#
..#.###...
...##.....
..#......#
.##.......
#...#.....
##...##.#.

Tile 2207:
#.#####.#.
#..#.#..##
...##....#
..#..#.#.#
#...###..#
.##.#...##
#..##..###
#.........
###.#..#.#
.#....##.#

Tile 1223:
###.....#.
#.....#.##
##.##.#...
#...##...#
#....#....
..#.##....
##....##..
..#..#....
.#.##..#..
###.#.####

Tile 1931:
##.#...###
#...##....
#..#....#.
..##..#...
#...#.....
.........#
###.##....
...##.#..#
.#.#.....#
..#..##.##

Tile 3917:
.##.#..#..
.......##.
#.##....##
...#....##
###....#.#
.##.#...##
###.......
##.....#..
....###.##
....#...#.

Tile 1663:
#.#.....##
.#.##.#..#
....#...#.
#...##...#
#..#......
.#..#.#..#
..#..#..##
...#......
#...##....
.##.######

Tile 3373:
#..###.###
##...#.#..
#..#..#..#
.#....##.#
..###..##.
...#.#...#
#.....#..#
##..#.....
.#..#.#...
.#...###.#

Tile 1319:
.#.#.#.#.#
.....#..##
..#.#.#.#.
.#.##...#.
..##......
...#......
.#........
#..#.....#
#..##....#
.#.##.#..#

Tile 2687:
#...###.#.
##.#...##.
#...#...##
#..##....#
......#.#.
.###.#.#..
##...#..##
......#..#
..........
#.....##.#

Tile 2003:
.######...
.##...###.
....#.....
#.###.#.#.
......#..#
..##.#.#.#
#.##..#.#.
####.#....
#...#.#.##
......##.#

Tile 1453:
###.#.####
...###..#.
.#..#..###
..#......#
#.#..#..##
..#..#.#..
#.#...#.#.
..##..#.#.
#..###....
..#..#..##

Tile 1871:
..#..#####
##..#....#
##.......#
#..#..#..#
#.....#.#.
#..###....
..........
.#........
.#.##.##.#
#.#..#.###

Tile 3709:
.##.#.##..
.#..##...#
.##.......
..##.#....
.........#
....#.....
###.#.##..
.#####....
#####.#...
..#..#####





