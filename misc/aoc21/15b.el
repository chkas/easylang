# AoC-21 - 15: Chiton
# 
# part two only
# 
inp$ = input
sz = len inp$
nc = 5 * sz + 1
for i range nc
  m[] &= 0
.
repeat
  for i range sz
    m[] &= number substr inp$ i 1
  .
  for _ range 4
    for i range sz
      m[] &= m[len m[] - sz] mod 9 + 1
    .
  .
  m[] &= 0
  inp$ = input
  until inp$ = ""
.
for _ range 4 * sz
  for i range sz * 5
    m[] &= m[len m[] - sz * nc] mod 9 + 1
  .
  m[] &= 0
.
for i range nc
  m[] &= 0
.
# 
endpos = len m[] - nc - 2
pos = nc
todo[] &= pos
cost[] &= 0
cost = 0
while len todo[] > 0
  for i range len todo[]
    pos = todo[i]
    if cost[i] <> cost
      costn[] &= cost[i]
      todon[] &= pos
    else
      if pos = endpos
        print cost
        break 2
      .
      for posn in [ pos - nc pos + 1 pos + nc pos - 1 ]
        if m[posn] > 0
          todon[] &= posn
          costn[] &= cost + m[posn]
          m[posn] = 0
        .
      .
    .
  .
  swap todon[] todo[]
  swap costn[] cost[]
  todon[] = [ ]
  costn[] = [ ]
  cost += 1
.
# 
input_data
7726919439592996115339919247419419361711839164558895996848969628934816999885895368482989269416899469
8891347887829767885136589542685347191689119896325426872735289289827388835396519229948998992691961199
8219593893362477231797986716791487992618993673869149625872799185457266928418111439978979499649657116
1716151148932129352957947499874989967158696291853653577314838616947289899197937994116929645893448948
9876992769768991495684323412235991913983961717968883292795436189247849182821912198136281147229684989
2986419982949966869289839825315379192693536826366772829776134345924493719881996819819185992615639958
1941549689175116772742741989278177812131718448337291452625954589883441177185677783589998277248712873
4613998828276181819972871351854247349873988923246942892432632229897136989192159828569689998595428194
8838755668439135178154829147999144797679743239696333577698893739963272896232341378655983496939889818
1547559639115889459891982249971873892689318242995719378888996967686938175892199491995468821891887916
9581828127799499925275632914272547172479998986999158155932313761166475926954698589249668988198123118
5391898715241419939191781963914819841374328788782888191858579755376535496958981945238585293814918983
2452695991178961119314272189991263791292324781139549775687499529788189929716759892233783596796981989
8198984884927497998893659972911898146834978615991697119615789989691219519898678191679224117739492937
7819353919964498565189117991427981168399699397856448798497881889117239357289477669698391183922959959
1591324641684129483588393946537984193681992292994798911195517929111758772111861985851763262289442911
9376192722688349939657937569589897973654699383367259995675535861858919813975918481189717657285533738
6829629589258173642265968569996979414456767212698629491466866429198681859891998994875918164499711819
4436756749763194459324241911889914189636177927599714249573874727917928291519984533793799171717989899
1717427762999354978991395583678467859791869733999792717911827248294398392889174599548929694881118555
6972719976199794385913961588799911717998937779711972931671772966568999899833625987725999117298885798
9976497189128743332793652537993519682965131919674718666959997997779392254982998946991939853918545679
9937666141258159179873493161128397642297824436839568894925117919629817788863567296499451296113935728
4353478927763934498729469619981625352899979926939223975164792157996193297951972839921968691484469948
5566882727183916735899985692939651949666261912489451499619369818911471129811188259194893489891928691
5169359955689971726968927927937287298958797875118287587967834996977994298267746169999496382941119394
1237689792617381134998689491594871966211937357811899439398923824993881779898925894432361989734491425
8729599778938529193419726628122181699997981991932974385887148489429699198881895878834299559842839393
1817597974987936439792941969979799695913967467429788116568949291117727939651788869919617328834779193
9993689199821581213542161864939151899621985779679397721751419929232917195317712161767961186328789959
4991193678888599729187822199379679653772646889499919617918993898238698429666786675986949489698962464
7751699683991919419971368586632159919676686892982317129957987745978599178129817327916275256698989352
9772719988139118939913199271746177252877345558186929898652599164988116551916991528135419876254785851
5699688953895925819227796354661814999186559639958277269849844843642898959883998989384596199798715187
4996115892582719698136655386597721399974819657893828187796991975955651197839777117865169894859897982
4738895887172834992369593921592499175814288117593994822174411193554112245198197481394839819198377991
9891668916612837491544899961918294275969977391539255998778359927122199772819991115919486919947191591
8168929442197543281529373693338557794789298376128497831643247692972212138258968711618445983619868879
5769897317194557527613292772387992368578147218482831988181554982812292917928117847339585812649518999
8332969936529432288967659119687175211959656171867741698691699697337889511271259573143249319719722953
5732892697599881478916475168152879221631231429582999979819694958966978859884991461767969379458181499
6183771963818528729146718356597364759911827898958694239294179629411739892228776713824997693966998227
7117459579726639118728783526699958993454812128928673389694812539169912897935786959596985769999844119
9799298618539114122868433329468697615169767242211529451769694818649728513938149747552983717178658979
9911254618926852369794119655712287795193991981988112791998877831927279418948685937798294659499993924
5127718878863485887979829268911293481982721713719552287821692879938925129675989521849199899499589481
1796457889668394346277168914816115412749969989291816174841667431939122183791971134952991687963742156
5579999379816559589595493644696796276431523699999518711289881456697488988996976891919599689389921185
9919996191129271159994789259874448874799822895291594555778449916943771845289949712899599982261789982
5289196314942251897411665839941981196944728918297319799799956527568511339797198626156399461997671828
1788341721169435679263974332889687389741997115991699742527619874826115989451956171889915359957871849
1916718998739978955728591854976999795728421878311963312594599499489788291418678946654981555519679929
7954932836139967612196275794413311919812299337917978629789775614699816828787228117887125168699133315
7199693953474836414596482989536859418692212919711589918999711742159153986562448551281833999799537953
9994198914919379998764681387766258393368858188898887146541971182897891368555199482996732121933719979
9999843579989149293131799853838628917158145988169429886889911122838478575799392181245926198899956197
2953941691112619979967446196677252188869999484588334946759212994196294327739566838931467544231999444
8844427818822545955928279296245979141698518711713398432618599125774619897331599191318987959349515929
1399559272911373972469497995949741699942659299995486998975199823912679159111999817473931899943228299
3998783838941765157684775381834995731371241986229138752634924889299238961319941688167897585472258999
9785793847191589982636977588969981142141192119883948977895662369988287188612678983759779947546988773
7988831194971457631866982948987953712784567972659618382774535356415269692989848414627963189774528798
5966963992769525399319171911297834787746868843599995214839141287122181998476381212792478318548188877
6791783129711548572999159381719689678688512591689893699174112713652999831599422961963596615682491695
3812266885231536872388142986289937846925671598872572852973734143725186544919417294129499113933644987
4879791998368485386691698399872978947918527818763195991213691877818979127399813687898178951235849379
6998679971234919499767441842119139815396219899791499931971932894996129741369287427899514821991742718
1971936723428572282496589942276989488918849619897893427188686597252852823922997918139439734661988392
8939177817346191242879711478899174868723961835675376319779918213749119916746924381844553794418261929
9934615749539788788984131898893949414161348369128213167112199765993162754129998821682191969385912177
9292399643395169992189998898969451541421932918446493338988114961157469928833428445452969471817131577
9397235945459874392591814199655438965943487941941912918668616149598294618671589994679255771698511626
4969987452519993842894667883918168827778586429759598326997379853637164791599141658499891879438897961
8996999941912959998219391941599854962876698889216949419622238887876928569919587375886896184868798994
8143299569134151926892483926892521889239319992911796979956167687929517898889791387518932968971792594
9788128341391929938691987778889692346282115188697481999659889678879577821969336941761278888281719819
9828897142599721371338472496995922179574613437852914218849418542954128921281498213864398178822681996
8939911566288235769242938977895691126979999288537198979355937735898432243194935415979597985639816558
4321847116981548799213811739499113999779698999926319139455788989972326889964987894588983759998963148
9698284174429888119948591985761797289347498771517974291289978699176839816972988339388943238911794476
8349415991575649196982578376798235249261895158299929256768679253786839823744448551395798972942999739
7418999919778193188182933515414489317451996239633999918711244781964434881687121328742718993939649819
7889659793197697925799915893995948969979319378838777293543883699477919252978228735172432511953795182
8999973191938593929291273931249954977747997575444925291982795869171849984772988155697231833929945861
8791179183966992637589997699393291988761287347269919995859596967987187862115987344487169838188199156
7911799187746399367231662148295965981996997922696811281261888197719699935744847698851215273673799799
9168959279895277991131898293213796595478284215392289197133421149818779779433886969798579763197987199
9695916919139199899918895184929971461735798388981815886854854181125616988988349714694136356719826735
3337197162523873651231299958298499726524977398397699366818829957721693436324125298712731442974182989
9479999965881391525919898719279999585591561957493135812697957876989988775629271964396848179961962523
1891894615423188823981196179591989719613169799588119697771886329716311168184929265412895142819925198
6588362471887679592969914443295959616797668749629492754352435863929894525739893129917764466121581589
9984911885116569916979959311385961957911915996989889899699615796922455834137915141788693548692689213
9819128418529181995314948188812836999493498999772229381879589461491744198797981482328949676982114681
7718169494998371593529979792476826949165786895997579857368319959823876868985419591318238815133639248
6941932192699199371783755674355999193957957271997819815769836999756849879183139198999499781857863289
8618672571493991299569947195922775539729673164794818994357999752989689195676619598998198998915377114
7397869911839155817222681519879188929181949559748979989911657996346893698178233173997874978858548286
6458187765719999965682889181858676717591199992156114429999591958839942838865918949668299489577698961
3924582179297298991133829718399929842231248861129869893879818945689871573531488991818177817861994789

